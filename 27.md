NIP-27
======

Nostr Unassuming Markup Language (NUML)
---------------------------------------

`draft` `mandatory`

Unless explicitly specified otherwise, text content in nostr events MUST follow the guidelines below for balancing human readability and embedded links. Client MAY parse and display content to improve the aesthetics of displayed content.

# Recognized Formatting

- A `>` at the beginning of a line followed by a single space MAY be used to indicate quotations
- A `#` at the beginning of a word MAY be used to indicate a topic and SHOULD have a corresponding `t` tag
- A `$` at the beginning of a word MAY be used to indicate a stock ticker
- Matched `*` characters within a single line MAY be used to indicate emphasis
- Matched `:` characters around a single word MAY be used to indicate emojis (see [NIP 30](./30.md))
- Single-backticks with no language tag MAY be used for inline code blocks
- Triple-backticks with no language tag MAY be used for multi-line code blocks
- Unordered lists MUST be one level deep, contain only one line, and SHOULD use the `-` character followed by a single space.
- Ordered lists MUST be one level deep, contain only one line, and MUST be sequentially numbered using decimals, followed by a period and a space. Out-of-order numbers SHOULD be rendered as such.

## Example

```
> This is a multiline quote
>
> And it ends here

#bitcoin $BTC *emphasis* :custom_emoji: `inline code`

- This
- is
- an
- unordered
- list

1. This
2. is
3. an
4. ordered
5. list
```

# Embedding References

URLs (excluding base64 encoded image data), [NIP 19](./19.md) nostr entities (prefixed with `nostr:`), and [NIP 73](./73.md) external content ids MAY be embedded in NUML `content`.

Clients MAY display these references as-is, or they MAY use special handling when rendering them. When rendering references:

- Inline references SHOULD be handled differently from references placed on their own line.
- References on their own line MAY be rendered by embedding a representation of them (an image, video, card, audio player, etc).
- Domain names without schema or path (e.g. `nytimes.com`) SHOULD be rendered as text.

When publishing content:

- A [NIP 18](./18.md) `q` tag pointing to any `nostr:nevent1...` or `nostr:naddr1...` references MAY be included if filtering by quoted entity is desired.
- A [NIP 02](./02.md) `p` tag pointing to any `nostr:pub1...` or `nostr:nprofile1...` references MAY be included if notifying the tagged user is desired.
- A [NIP 92](./92.md) `imeta` tag SHOULD be included for any media URLs in the content.
- When a user manually pastes a [NIP 19](./19.md) entity, publishing clients SHOULD prefix the entity with `nostr:` before publishing.

## Example

Suppose Bob is writing a note in a client that has search-and-autocomplete functionality for users that is triggered when they write the character `@`.

As Bob types `"hello @mat"` the client will prompt him to autocomplete with [mattn's profile](https://njump.me/npub1937vv2nf06360qn9y8el6d8sevnndy7tuh5nzre4gj05xc32tnwqauhaj6), showing a picture and name.

Bob presses "enter" and now he sees his typed note as `"hello @mattn"`, `@mattn` is highlighted, indicating that it is a mention. Internally, however, the event looks like this:

```json
{
  "content": "hello nostr:nprofile1qqszclxx9f5haga8sfjjrulaxncvkfekj097t6f3pu65f86rvg49ehqj6f9dh",
  "created_at": 1679790774,
  "id": "f39e9b451a73d62abc5016cffdd294b1a904e2f34536a208874fe5e22bbd47cf",
  "kind": 1,
  "pubkey": "79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798",
  "sig": "f8c8bab1b90cc3d2ae1ad999e6af8af449ad8bb4edf64807386493163e29162b5852a796a8f474d6b1001cddbaac0de4392838574f5366f03cc94cf5dfb43f4d",
  "tags": [
    [
      "p",
      "2c7cc62a697ea3a7826521f3fd34f0cb273693cbe5e9310f35449f43622a5cdc"
    ]
  ]
}
```

After Bob publishes this event and Carol sees it, her client may display the `.content` as it is or it may parse the `.content`, decode the `nprofile` reference, extract the public key from it (and possibly relay hints), fetch that profile from its internal database or relays, then replace the full URL with the name `@mattn`, with a link to the internal page view for that profile.
