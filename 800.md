NIP-800
======

BDD Payload Execution Protocol
------------------------------

`draft` `optional`

This NIP defines `kind:800` (BDD execution request) and `kind:801` (BDD execution result).
It standardizes how a client can publish a Behavior-Driven Development (BDD) test payload to Nostr
and how an **opt-in executor** can publish a signed result.

This NIP does **not** require general-purpose relays to execute arbitrary computation.
Execution is performed by specialized, opt-in services ("executors") that may also operate as relays.

---

Motivation
----------

Teams want a simple, interoperable way to publish **portable, human-readable test cases** and obtain
**auditable execution results** that can be queried and verified by anyone.

This is useful for:
- Cross-team coordination on expected behavior (canonical Gherkin as the payload)
- Public, immutable execution logs (results are events signed by the executor)
- Reproducible regression evidence and external verification

This is **not** intended to replace centralized CI/CD for general workloads.
It defines a narrow protocol for publishing BDD payloads and signed results over Nostr.

---

Definitions
-----------

- **Executor**: an opt-in service that listens for `kind:800`, runs the test payload in a sandbox,
  and publishes `kind:801` results. Executors MAY also be relays.
- **Payload**: the canonical BDD text, typically Gherkin.
- **Result**: machine-readable summary and optional logs, signed by the executor.

---

Event: BDD Execution Request (kind:800)
---------------------------------------

### Content

`content` MUST be a UTF-8 string containing the BDD payload.
The canonical form SHOULD be Gherkin (`Feature: ... Scenario: ...`).

### Tags

A `kind:800` event SHOULD include:

- `["d", <dedupe-id>]`
  Deterministic identifier for this request (e.g. hash of canonical payload + optional runner hints).
  Useful for idempotency / avoiding duplicate execution.

- `["name", <human-readable-name>]` (optional)
  Human-friendly label.

- `["suite", <suite>]` (optional)
- `["feature", <feature>]` (optional)
- `["scenario", <scenario>]` (optional)

- `["lang", "gherkin"]` (recommended)
  Payload language identifier.

- `["executor", <hint>]` (optional)
  Executor selection hint (e.g. a well-known executor pubkey, NIP-19 reference, or a string namespace).
  Executors MAY ignore this.

- `["timeout", <seconds>]` (optional)
  Requested max execution time. Executors MAY cap.

- `["input", <key>, <value>]` (optional, repeatable)
  Small inputs/parameters that do not belong in the human-readable feature text.

Executors and clients MUST ignore unknown tags.

### Example

```json
{
  "kind": 800,
  "content": "Feature: Health\n  Scenario: Ping\n    Given I am using server \"https://example.com\"\n    When I make a GET request to \"/health\"\n    Then the response status must be \"200\"\n",
  "tags": [
    ["d", "bdd:sha256:..."],
    ["lang", "gherkin"],
    ["suite", "smoke"],
    ["feature", "Health"],
    ["scenario", "Ping"]
  ]
}
