NIP-05
======

DNS-based identifiers
---------------------

`final` `optional`

Users can declare their control over one of more DNS-based internet identifiers in kind `10008`. 

```yaml
{
  "kind": 10008,
  "tags": [
    ["n", "<name>@<domain>"],
    ["n", "name@domain.com"],
    ["n", "name2@domain2.com"],
  ],
  "content": "",
  //...
}
```

Internet identifiers follow [RFC-5322](https://datatracker.ietf.org/doc/html/rfc5322#section-3.4.1) with the exception that `<name>`s MUST only use characters `a-z0-9-_.`.

Supporting Clients split the identifier into `<name>` and `<domain>` and use these values to make a GET request to `https://<domain>/.well-known/nostr.json?name=<name>`.

The result MUST be a JSON document with two properties: `names` and `relays`: 

```yaml
{
  "names": {
    "bob": "b0635d6a9851d3aed0cd6c495b282167acf761729078d975fc341b22650b07b9"
  },
  "relays": {
    "b0635d6a9851d3aed0cd6c495b282167acf761729078d975fc341b22650b07b9": [ "wss://relay.example.com", "wss://relay2.example.com" ]
  }
}
```

The property `names` MUST contain a mapping of names to hex formatted public keys, in lowercase. 

The property `relays` is optional, but when present MUST contain an array of relay urls where the events from this key can be found. 

A valid NIP-05 identifier MUST match the resulting public key to the pubkey of the `10008` event.

A domain MAY offer the complete `https://<domain>/.well-known/nostr.json` with all names and relay information for all users.

### Root Identifiers

Clients MUST treat the identifier `_@<domain>` as the "root" identifier and MUST display it as just the `<domain>`. For example, if Bob owns `bob.com`, he may not want an identifier like `bob@bob.com` as that is redundant. Instead, Bob can use the identifier `_@bob.com` and expect Nostr clients to show and treat that as just `bob.com` for all purposes.

### Allowing access from JavaScript apps

Servers MUST provider their `/.well-known/nostr.json` documents with the HTTP header `Access-Control-Allow-Origin: *` to ensure it can be validated by pure JS apps running in modern browsers, avoiding [CORS](https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS) issues.

```bash
$ curl -sI https://example.com/.well-known/nostr.json?name=bob | grep -i ^Access-Control
Access-Control-Allow-Origin: *
```

### Security Constraints

Servers MUST offer the `/.well-known/nostr.json` endpoint without any HTTP redirects.

Clients MUST ignore any HTTP redirects given by the `/.well-known/nostr.json` endpoint.

## Finding users from their NIP-05 identifier

A client may implement support for finding users' public keys from _internet identifiers_, the flow is the same as above, but reversed: first the client fetches the _well-known_ URL and from there it gets the public key of the user, then it tries to fetch the kind `0` event for that user and check if it has a matching `"nip05"`.

## Notes

### Identification, not verification

The NIP-05 is not intended to _verify_ a user, but only to _identify_ them, for the purpose of facilitating the exchange of a contact or their search.  
Exceptions are people who own (e.g., a company) or are connected (e.g., a project) to a well-known domain, who can exploit NIP-05 as an attestation of their relationship with it, and thus to the organization behind it, thereby gaining an element of trust.

### User discovery implementation suggestion

A client can use this to allow users to search other profiles. If a client has a search box or something like that, a user may be able to type "bob@example.com" there and the client would recognize that and do the proper queries to obtain a pubkey and suggest that to the user.

### Clients must always follow public keys, not NIP-05 addresses

For example, if after finding that `bob@bob.com` has the public key `abc...def`, the user clicks a button to follow that profile, the client must keep a primary reference to `abc...def`, not `bob@bob.com`. If, for any reason, the address `https://bob.com/.well-known/nostr.json?name=bob` starts returning the public key `1d2...e3f` at any time in the future, the client must not replace `abc...def` in his list of followed profiles for the user (but it should stop displaying "bob@bob.com" for that user, as that will have become an invalid `"nip05"` property).

### Public keys must be in hex format

Keys must be returned in hex format, in lowercase. Keys in NIP-19 `npub` format are only meant to be used for display in client UIs, not in this NIP.

### Reasoning for the `/.well-known/nostr.json?name=<local-part>` format

By adding the `<local-part>` as a query string instead of as part of the path, the protocol can support both dynamic servers that can generate JSON on-demand and static servers with a JSON file in it that may contain multiple names.