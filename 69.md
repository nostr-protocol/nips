NIP-69
======

Content Moderation Using NIP-68 Labeling
----------------------------------------

`draft` `optional` `author:s3x-jay` `author:rabble`

## Purpose

To define how content moderation can be accomplished using NIP-68 labeling.

## Background

Just as the MeSH vocabulary, referenced in NIP-68, helps scientists and medical professionals communicate effectively and find articles on a particular topic quickly, people (and automated agents) performing content moderation tasks on Nostr need a defined vocabulary to communicate effectively and find and act on particular types of moderation reports quickly. 

While __content moderation is completely optional on Nostr__, these vocabularies are needed because many relay owners feel the need to stay compliant with their local laws as well as the standards and preferences of the communities they serve. Additionally, client apps need to cater to the preferences of their users and sometimes to the standards imposed by the app stores they're listed in. 

The fact that something is in a moderation vocabulary says nothing about the ethical or moral quality of that type of content. 

## The MOD vocabulary

NIP-68 `vocab`: "MOD"

The MOD vocabulary includes moderation categories believed to address the most likely moderation cases. By design it is not a full, comprehensive list of every possible moderation category. More specialized or regional issues are handled by the `X-MOD` vocabulary, discussed below.

There is no requirement for anyone to use the entire MOD vocabulary, or even most of it. Different parts of the vocabulary are relevant in some contexts but not in others. Clients apps and moderators should only use the portion of the vocabulary that applies to their particular situation. Use of the full  MOD vocabulary is not required for an app to claim it supports this NIP.

Client apps which support content reporting should not overwhelm users with too many choices. Sub-categories should only be displayed after the user chooses the general category. The two "HC" sub-categories intentionally have no general category and should be shown along with the general categories. Client apps are further encouraged to make use of geolocation data, if available, to hide categories/sub-categories that are not relevant in the user's country or region.

The MOD vocabulary is made up of reportable types and contexts…

### Reportable Types

Reportable types are categories of posts which are often moderated.

**_Format:_ "AB-cde"**
- where 'AB' is a mandatory 2 character, uppercase code of a major content type category
- and 'cde' is an optional 3 character, lowercase code representing a sub-category

TypeCode | Type | Public Notes | Development Notes
--- | --- | --- | ---
CL |  Coarse Language / Profanity | |
HC-fin | Promotion of content that is likely to cause financial ruin | consider also Fraud & Scams |
HC-bhd | Promotion of content that is likely to cause serious bodily harm or death | |
IH | Intolerance & Hate | does not include intolerance of intolerance | |
IL | Illegal Content | post/profile itself is illegal or advocates illegal activity |
IL-cop | Copyright violation, piracy, intellectual property theft | |
IL-csa | Child sexual abuse and/or trafficking | |
IL-drg | Drug-related crime | |
IL-frd | Fraud & Scams | |
IL-har | Harassment / stalking / doxxing | | if applicable, the npub or nprofile of the victim should be specified using `support`
IL-swk | Prostitution | | relevant countries: https://en.wikipedia.org/wiki/Prostitution_by_region
IL-idt | Impersonation / identity theft / phishing | | if applicable, the npub or nprofile of the victim should be specified using `support`
IL-mal | Malware / viruses / ransomware | | not applicable if there is no URL or file
NA | None of the above | | for use when the user wants to report something but none of the categories or contexts apply
NS | Nudity & Sex | for use when there is no intention to arouse |
NS-nud | Casual nudity | |
NS-ero | Erotica | |
NS-sex | Sex | |
PG | No Sensitive Content | for use in situations where sensitive content might be assumed |
PN | Pornography | for use when there is an intention to sexually arouse |
PN-het | Heterosexual porn | |
PN-gay | Gay male porn | | relevant countries: https://en.wikipedia.org/wiki/LGBT_rights_by_country_or_territory
PN-les | Lesbian porn | |
PN-bis | Bisexual porn | |
PN-trn | Transsexual porn | |
PN-fnb | Gender-fluid / non-binary porn | |
SP | Spam | |
SP-mod | Moderation report spam | | moderators should use `appliesto` (some ReportType/ContextType) and `support` (example Nostr IDs) when reporting a profile for moderation spam
VI | Violence | actual or advocated | |
VI-hum | Violence towards a human being | |
VI-ani | Violence towards a sentient animal | |

### Contexts

Contexts are situations where otherwise objectionable content might be allowed.

**_Format:_ "AB"**
- where 'AB' is a mandatory 2 character, uppercase code of a context type

ContextCode | Context
--- | ---
ED | Educational
FA | Fine Art
FF | Fantasy / Fiction
MS | Medical / Scientific
ND | News & Documentaries
PP | Political Protest

### Translations

The descriptions for each type and context code will need to be translated into other languages to facilitate international use. This NIP should be amended after a decision is made on how to best store and retrieve those translations.

## The X-MOD vocabulary

NIP-68 `vocab`: "X-MOD"

The MOD vocabulary does not cover all cases where content will need to be moderated - only the cases that are likely to encompass the largest number of moderation reports. The X-MOD vocabulary will fill the gap of other cases that could use something better than an unstructured free-form text field.

The X-MOD vocabulary is intended to be organic. People and entities doing content moderation can implement terms as they see fit - in coordination with others who will use those terms. The X-MOD vocabulary is a good way to test the use of new terms before including those terms in the MOD vocabulary. It will also be useful for regional moderation issues that may never have enough use to be included in MOD.

The TypeCodes/ContextCodes for X-MOD do not need to follow the same structure as the MOD vocabulary unless the intent is for the code to eventually be integrated into the MOD vocabulary. In that case the format should be "AB-cde" as it is in the MOD vocabulary.

Should a code used in the X-MOD vocabulary later be elevated to the MOD vocabulary, client apps should treat the two codes in the same way - "X-MOD>AB-cde" should be treated the same way as "MOD>AB-cde".

## Action labels used by both vocabularies

When a user specifies moderation labels, no matter if they use one of the structured vocabularies or an unstructured label, they may specify a recommended action that can be taken into consideration by those using their labeling. These labels are:

LabelCode | Meaning | Suggested defaults
--- | --- | ---
display | Do not warn users about or filter this content | default for all cases of `MOD>PG`
warn-public | Warn people who do not follow the account before content is displayed | default if a context is specified
warn-all | Warn all viewers before content is displayed | default for other cases
filter | Filter content if user does not follow the account, but do not delete from relays | default for all cases of `MOD>IL`
delete | Delete content from relays, filter until that happens | 

Support of action labels is completely optional. 

A `vocab` value of `MOD` should be used with these label codes.

## Content moderation using NIP-68 labeling

Content moderation will be accomplished via a mix of self-labeling (by responsible users publishing "sensitive" content), and 3rd party labeling after the fact. 

### This NIP deprecates both NIP-36 and NIP-56

- [NIP-36](https://github.com/nostr-protocol/nips/blob/master/36.md) is deprecated because labeling uses the more general `l` and `label` tags rather than the use-specific, unstructured `content-warning` tag.
- [NIP-56](https://github.com/nostr-protocol/nips/blob/master/56.md) is deprecated because replaceable events are required for labeling and kind 1984 is not replaceable.

### Self-labeling of sensitive content at time of event publication

Users with content that is likely to be considered "sensitive" can label their content at the time it is published by including `l` and `label` tags in their event at the time of publishing. 

Example: 
```json
{
    "pubkey": "<pub-key>",
    "created_at": 1000000000,
    "kind": 1,
    "tags": [
      [ "t", "WetTShirt" ],
      [ "l", "MOD>NS-ero" ],
      [ "l", "MOD>warn-public" ],
      [ "label", "Wet t-shirt contest" ]
    ],
    "content": "(Racy content goes here)",
    "id": "<event-id>"
}
```

Users can self-label their own profile if other users are likely to see "sensitive" content on the profile page.

Example: 
```json
{
    "pubkey": "<pub-key>",
    "created_at": 1000000000,
    "kind": 0,
    "tags": [
      [ "t", "LifeDrawing" ],
      [ "l", "MOD>NS-nud" ],
      [ "l", "MOD>FA" ]
    ],
    "content": "{\"name\":\"OttawaLifeDrawing\",\"about\":\"Ottawa's newest life drawing classes!\"}",
    "id": "<event-id>"
}
```

Users can use labels to define the way in which certain elements of their profile may or may not be sensitive using `appliesto`. Extending that type of labeling, users can set a default, assumed label for items in their feed by saying the code applies to `feed` even though `feed` is not an element of their profile's `content`.
```
...
[ "l", "MOD>AB-cde", "[\"appliesto\": \"feed\"]" ]
...
```
Client apps should apply this label when MOD or X-MOD labels are not present on a post. Users can turn off their default label for a particular post by including labels in the post or using a kind 32144 event to label the event after publication.

In the example below the user has marked their feed as "X-MOD>IL-kng" in an attempt to say they're engaged in technically illegal activity to end the monarchy in the UK. They've also noted that their avatar picture is not "sensitive", but their website advocates violence. Additionally they've specified that they are engaged in political protest which should be taken into consideration as a mitigating context.

Example:
```json
{
    "pubkey": "<pub-key>",
    "created_at": 1000000000,
    "kind": 0,
    "tags": [
      [ "t", "UKrepublican" ],
      [ "l", "X-MOD>IL-kng", "[\"appliesto\": \"feed\"]" ],
      [ "l", "MOD>PG", "[\"appliesto\": \"picture\"]" ],
      [ "l", "MOD>VI-hum", "[\"appliesto\": \"website\"]" ],
      [ "l", "MOD>PP" ],
      [ "l", "MOD>display" ]
    ],
    "content": "{\"name\":\"EndUKMonarchy\",\"about\":\"Monarchy in the UK needs to end! (by force if necessary)\",\"banner\":\"https://somesite.com/somepic.jpg\",\"website\":\"https://somesite.com\",\"picture\":\"https://somesite.com/anotherpic.jpg\"}",
    "id": "<event-id>"
}
```

### Labeling / reporting of content after publication

This NIP modifies [NIP-10](https://github.com/nostr-protocol/nips/blob/master/10.md) by adding a `marker` of `report`, which SHOULD be used on `e` tags.

Otherwise, labeling after publication follows all the same conventions as labeling at the time of publication, only it uses kind 32144…

Example: User reporting a post about a wet t-shirt contest...
```json
{
  "kind": 32144,
  "pubkey": "<pubkey of labeler>",
  "tags": [
    ["d", "labels-<eventid of event being labeled>"],
    ["e", "<eventid of event being labeled>"],
    ["p", "<pubkey of event being labeled>"],
    ["l", "MOD>NS-ero"]
  ],
  "content": "Wet t-shirt contest",
  "id": "<event-id>"
}
```

Example: A nudity detection bot reporting it's finding about a post...
```json
{
  "kind": 32144,
  "pubkey": "<pubkey of labeler>",
  "tags": [
    ["d", "labels-<eventid of event being labeled>"],
    ["e", "<eventid of event being labeled>"],
    ["p", "<pubkey of event being labeled>"],
    [ "l", "MOD>warn-public" ],
    ["l", "MOD>NS", "{\"confidence\":0.62}"]
  ],
  "content": "",
  "id": "<event-id>"
}
```

Example: A bot reporting results after it compared a file from a NIP-94 event to a database of known CSAM...
```json
{
  "kind": 32144,
  "pubkey": "<pubkey of labeler>",
  "tags": [
    ["d", "labels-<eventid of event being labeled>"],
    ["e", "<eventid of event being labeled>"],
    ["p", "<pubkey of event being labeled>"],
    [ "l", "MOD>delete" ],
    ["l", "MOD>IL-csa", "{\"confidence\":1,\"degree\":1,\"support\":\"https://domain.com/csam-verifier?dbid=123\"}"]
  ],
  "content": "It is recommended that all relay owners delete this event immediately and block all future NIP-94 events with the same hash.",
  "id": "<event-id>"
}
```

Example: Labeling a profile and it's component elements
```json
{
  "kind": 32144,
  "pubkey": "<pubkey of labeler>",
  "tags": [
    ["d", "labels-<eventid of event being labeled>"],
    ["e", "<eventid of event being labeled>"],
    ["p", "<pubkey of event being labeled>"],
    [ "l", "#>TransFem" ],
    [ "l", "MOD>PN-trn", "[\"appliesto\": \"feed\"]" ],
    [ "l", "MOD>PG", "[\"appliesto\": \"picture\"]" ],
    [ "l", "MOD>PN-trn", "[\"appliesto\": \"website\"]" ],
    [ "l", "MOD>NS-ero", "[\"appliesto\": \"banner\"]" ]
  ],
  "content": "Profile is for a trans pornstar.",
  "id": "<event-id>"
}
```
Note that the example above shows how other, non-moderation tags can be included in the same kind 32144 report along with moderation tags.

Important: Users should not use kind 32144 events to label their own profiles. It is not a use case client apps need to support.

## Relay feature needed to support this NIP

For a relay to say it supports this NIP it MUST support the ability for unpaid relay users to submit kind 32144 events that have `vocab` values of "MOD" or "X-MOD", and are related to content on the relay (`e` tag equal to an eventID in the relay database). That ability SHOULD be on by default, but MAY be turned off by the relay webmaster.

This solves an existing legal problem for relay owners where an unpaid user may be able to read an event, but they can not submit a report about the event - leaving the relay owner in the position where they are unaware they are hosting potentially illegal content. 
