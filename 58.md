NIP-58
======

Badges
------

`draft` `optional`

Five special events are used to define, award, request, deny and display badges in
user profiles:

1. A "Badge Definition" event is defined as an addressable event with kind `30009` having a `d` tag with a value that uniquely identifies the badge (e.g. `bravery`) published by the badge issuer. Badge definitions can be updated.

2. A "Badge Award" event is a kind `8` event with a single `a` tag referencing a "Badge Definition" event and one or more `p` tags, one for each pubkey the badge issuer wishes to award. Awarded badges are immutable and non-transferable.

3. A "Profile Badges" event is defined as an _addressable event_ with kind `30008` with a `d` tag with the value `profile_badges`.
Profile badges contain an ordered list of pairs of `a` and `e` tags referencing a `Badge Definition` and a `Badge Award` for each badge to be displayed.

4. A "Badge Request" event is defined as an addressable event with kind `30058` where a user requests a badge from an issuer. The `d` tag contains the badge's `a` tag identifier, ensuring one active request per badge per user.

5. A "Badge Denial" event is defined as an addressable event with kind `30059` where an issuer formally denies a badge request. The `d` tag contains the request event id, ensuring one denial per request.

### Badge Definition event

The following tags MUST be present:

- `d` tag with the unique name of the badge.

The following tags MAY be present:

- A `name` tag with a short name for the badge.
- `image` tag whose value is the URL of a high-resolution image representing the badge. The second value optionally specifies the dimensions of the image as  `width`x`height` in pixels. Badge recommended dimensions is 1024x1024 pixels.
- A `description` tag whose value MAY contain a textual representation of the
image, the meaning behind the badge, or the reason of its issuance.
- One or more `thumb` tags whose first value is an URL pointing to a thumbnail version of the image referenced in the `image` tag. The second value optionally specifies the dimensions of the thumbnail as `width`x`height` in pixels.

### Badge Award event

The following tags MUST be present:

- An `a` tag referencing a kind `30009` Badge Definition event.
- One or more `p` tags referencing each pubkey awarded.

### Profile Badges Event

The number of badges a pubkey can be awarded is unbounded. The Profile Badge
event allows individual users to accept or reject awarded badges, as well
as choose the display order of badges on their profiles.

The following tags MUST be present:

- A `d` tag with the unique identifier `profile_badges`

The following tags MAY be present:

- Zero or more ordered consecutive pairs of `a` and `e` tags referencing a kind `30009` Badge Definition and kind `8` Badge Award, respectively. Clients SHOULD
ignore `a` without corresponding `e` tag and viceversa. Badge Awards referenced
by the `e` tags should contain the same `a` tag.

### Badge Request event

An addressable event where a user requests a badge from an issuer.

The following tags MUST be present:

- A `d` tag with the badge's `a` tag identifier (e.g. `30009:<issuer-pubkey>:<badge-d-tag>`)
- An `a` tag referencing the kind `30009` Badge Definition event
- A `p` tag with the issuer's pubkey

The following tags MAY be present:

- One or more `proof` tags containing evidence to support the request (URL, text, or nostr event id)
- A `status` tag with value `withdrawn` to withdraw the request

The `content` field MAY contain a message to the issuer.

Publishing a new request for the same badge updates/replaces the previous one. Clients MUST ignore requests with `["status", "withdrawn"]`.

### Badge Denial event

An addressable event where an issuer formally denies a badge request.

The following tags MUST be present:

- A `d` tag with the request event id
- An `a` tag referencing the kind `30009` Badge Definition event
- An `e` tag referencing the request event
- A `p` tag with the requester's pubkey

The following tags MAY be present:

- A `status` tag with value `revoked` to revoke the denial

The `content` field MAY contain the reason for denial.

Denials are soft by design. A denied user MAY submit a new request for the same badge, generating a new event id and making the old denial obsolete. Clients MUST ignore denials with `["status", "revoked"]`.

### Request States

A badge request can be in one of four states, checked in priority order:

1. **Fulfilled** - A Badge Award (kind `8`) exists for this badge and user
2. **Withdrawn** - Request has `["status", "withdrawn"]` tag
3. **Denied** - A Badge Denial (kind `30059`) exists for this request (without `["status", "revoked"]`)
4. **Pending** - Request exists, none of the above apply

Clients SHOULD check for an existing award before displaying a denial.

### Motivation

Users MAY be awarded badges (but not limited to) in recognition, in gratitude, for participation, or in appreciation of a certain goal, task or cause.

Users MAY choose to decorate their profiles with badges for fame, notoriety, recognition, support, etc., from badge issuers they deem reputable.

Users MAY request badges they believe they are eligible for, optionally providing proof to support their request.

Issuers MAY formally deny requests, providing feedback to requesters on why they were denied.

### Recommendations

Clients MAY whitelist badge issuers (pubkeys) for the purpose of ensuring they retain a valuable/special factor for their users.

Badge image recommended aspect ratio is 1:1 with a high-res size of 1024x1024 pixels.

Badge thumbnail image recommended dimensions are: 512x512 (xl), 256x256 (l), 64x64 (m), 32x32 (s) and 16x16 (xs).

Clients MAY choose to render less badges than those specified by users in the Profile Badges event or replace the badge image and thumbnails with ones that fits the theme of the client.

Clients SHOULD attempt to render the most appropriate badge thumbnail according to the number of badges chosen by the user and space available. Clients SHOULD attempt render the high-res version on user action (click, tap, hover).

Clients SHOULD display a "Request Badge" option on badges the user does not have.

Clients SHOULD provide issuers with an inbox for incoming badge requests.

Clients SHOULD rate-limit request submissions to prevent spam.

### Example of a Badge Definition event

```jsonc
{
  "pubkey": "alice",
  "kind": 30009,
  "tags": [
    ["d", "bravery"],
    ["name", "Medal of Bravery"],
    ["description", "Awarded to users demonstrating bravery"],
    ["image", "https://nostr.academy/awards/bravery.png", "1024x1024"],
    ["thumb", "https://nostr.academy/awards/bravery_256x256.png", "256x256"]
  ],
  // other fields...
}
```

### Example of Badge Award event

```jsonc
{
  "id": "<badge award event id>",
  "kind": 8,
  "pubkey": "alice",
  "tags": [
    ["a", "30009:alice:bravery"],
    ["p", "bob", "wss://relay"],
    ["p", "charlie", "wss://relay"]
  ],
  // other fields...
}
```

### Example of a Profile Badges event

Honorable Bob The Brave:
```jsonc
{
  "kind": 30008,
  "pubkey": "bob",
  "tags": [
    ["d", "profile_badges"],
    ["a", "30009:alice:bravery"],
    ["e", "<bravery badge award event id>", "wss://nostr.academy"],
    ["a", "30009:alice:honor"],
    ["e", "<honor badge award event id>", "wss://nostr.academy"]
  ],
  // other fields...
}
```

### Example of a Badge Request event

Bob requests the bravery badge from Alice:
```jsonc
{
  "kind": 30058,
  "pubkey": "bob",
  "content": "I helped rescue the trapped hikers last month!",
  "tags": [
    ["d", "30009:alice:bravery"],
    ["a", "30009:alice:bravery", "wss://relay"],
    ["p", "alice"],
    ["proof", "https://news.example/hiker-rescue-article"]
  ],
  // other fields...
}
```

### Example of a Badge Denial event

Alice denies Bob's request:
```jsonc
{
  "kind": 30059,
  "pubkey": "alice",
  "content": "Please provide photo evidence or witness confirmation.",
  "tags": [
    ["d", "<bob's request event id>"],
    ["a", "30009:alice:bravery", "wss://relay"],
    ["e", "<bob's request event id>", "wss://relay"],
    ["p", "bob"]
  ],
  // other fields...
}
```
