NIP-00
======

Editable Event
--------------

`draft` `optional`

The uppercase `D` (deduplication) tag informs which one-letter tags of an event
should be used to uniquely identify an event besides the event's
`.kind` and `.pubkey` fields.

That is, when a relay receives a request to store an event with a `D` tag set to e.g. `"aa"`
(meaning first two `a` tags), if there's already a stored event with the **same** two `a` tags'
**values** (at any order), `.kind` and `.pubkey`, but with an older `.created_at` timestamp,
the old event must be replaced with the new one.

If the timestamps are the same, the event with the lowest id (first in lexical order)
should be retained, and the other discarded.

## "D" Tag

The `D` tag is set as follows: `["D", "<one-letter tag name list>", "<delimiter, non-letter char sequence - optional>]`.

The delimiter is used when [referencing](#referencing).
It is a recommended char sequence, that isn't (nor isn't expected to become) present on any of the listed tags' values.
It cannot include `:` and letters. If the delimiter isn't informed, `~` should be used when referencing.

- Examples with a single `e` tag: `["D", "e"]`
- Example with three tags and a custom delimiter: `["D", "eep", "<->"]`

### Event example:

```jsonc
{
  "kind": "99",
  "pubkey", "827ade3254c72ae811201b418766d9a8802e91b029d95cc9de2f0169274aedd7",
  "tags": [
    // relay will check for other events with j="12" and z="zz" (also same .kind and .pubkey) before storing this one
    ["D", "jz"],
    ["j", "12"],
    ["c", "abc"],
    ["j", "13"],
    ["j", "14"],
    ["z", "zz"],
    ["status", "ok"]
  ],
  // ...other fields
}
```

Note: Ideally, don't add more specific one-letter tags to the event than the number of their occurrences on the D tag value,
or else, one may risk inadvertently editing the wrong event. I.e., it would be better if the above event had only one `j` tag.

## Referencing

An `u`(unique) tag is used for referencing the latest version of an editable event and has the following value format:
"`<event kind>:<event pubkey>:<delimiter>:<tag name><tag value>`" or
"`<event kind>:<event pubkey>:<delimiter>:<tag name><tag value><delimiter><tag name><tag value><delimiter...`"

The delimiter should be the same from the `D` tag.

This NIP requires [NIP-119 (AND operator for fields)](https://github.com/dskvr/nips/blob/nip/119/119.md) support
for fetching an editable event by the fields informed on an `u` tag, if it includes the same tag more than once.

### Event example:

Referencing three events:

```jsonc
{
  "kind": 100,
  "pubkey", "38cdb0e540bc08beb647c7d786c2a3efa9348f9dbbfa66b55959f150310ced1a",
  "tags": [
    ["u", "99:827ade3254c72ae811201b418766d9a8802e91b029d95cc9de2f0169274aedd7:~:j12~zzz"],
    ["u", "102:827ade3254c72ae811201b418766d9a8802e91b029d95cc9de2f0169274aedd7:~:b908908098"],
    ["u", "1009:827ade3254c72ae811201b418766d9a8802e91b029d95cc9de2f0169274aedd7:<->:c123<->c456"]
  ],
  // ...other fields
}
```
