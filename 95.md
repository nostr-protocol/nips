NIP-XX
======

Optional X.509 Certificates for Decentralized Key Hierarchy and TTL
-------------------------------------------------------------------

`draft` `optional` `author:<your_username>`

This NIP introduces an optional enhancement to the existing Nostr protocol by allowing clients to include an X.509 compliant certificate in addition to the existing `pubkey` field as described in NIP-01. This would enable clients to embed additional metadata about the public key, such as the issuer and validity period. This feature is intended to improve identity and validity management for child/subordinate keys, compared to the existing NIP-26.

## Motivation

While the Nostr protocol is designed to be completely decentralized, with anyone able to generate their own private keys, the inclusion of X.509 certificates can provide additional benefits. Most certificates would be self-signed X.509 certificates by design, but this feature opens up the possibility for the root key (or the original self-signed X.509 certificate) to create and sign additional subordinate key pairs with time-to-live (TTL) values. This allows users who follow the root's pubkey to validate the identity and validity of child/subordinate keys, offering an improvement over NIP-26.

## Specification

To support X.509 certificates, we extend the `event` object format in NIP-01 with an optional field:

```json
{
  ...
  "x509_cert": <PEM-encoded X.509 certificate string or null>,
  ...
}
```

The `x509_cert` field can be included in the event object to provide an optional X.509 certificate. If the field is included, it should contain a valid PEM-encoded X.509 certificate string. If the field is not included or set to `null`, it will be treated as if no certificate is provided.

The optional `x509_cert` field should not affect the event serialization and signing process specified in NIP-01. The `x509_cert` field should be considered as additional metadata and should not be included in the serialized event data used for generating the `event.id` or the signature.

Clients that support this NIP should perform the following additional checks when processing events that include an `x509_cert` field:

1. Verify that the X.509 certificate is valid (i.e., not expired, not revoked, and signed by a trusted root or intermediate certificate authority).
2. Verify that the certificate's public key matches the `pubkey` field in the event object.
3. If the certificate is part of a chain, verify that the entire chain is valid and that any subordinate certificates have a valid TTL.

These checks provide additional security measures for clients that support this NIP, ensuring that they only process and accept events from trusted sources.

Relays supporting this NIP should store the X.509 certificates along with the events and include them in the events returned in response to client requests. Clients that do not support this NIP can safely ignore the `x509_cert` field when processing events.

## Backward Compatibility

This NIP is backward compatible with existing NIPs, as the `x509_cert` field is optional and can be safely ignored by clients that do not support it. Clients that support this NIP can still interact with clients and relays that do not support it, although they will not be able to take advantage of the additional security features provided by X.509 certificates.