NIP-82
======

Software Applications
---------------------

`draft` `optional`

This NIP defines kind 32267 to describe a software application, kind 30063 for a software release and kind 3063 for a software asset.

## Software Application

An application is a parameterizable replaceable event as a pubkey may maintain many different ones and update their description over time.

```jsonc
{
  "kind": 32267,
  // Full description of the application, markdown is allowed
  "content": "<description>",
  "tags": [
    [
      // REQUIRED
      // Reverse-domain identifier: com.example.app
      "d", "<app-id>"
    ], 
    [
      // REQUIRED
      // App name
      "name", "<human-readable project name>"
    ],
    [
      // Summary, short description, Markdown not allowed
      "summary", "<summary-text>"
    ],
    [
      // Icon URL
      "icon", "<icon-url>"
    ],
    [
      // MULTIPLE
      // Image URL
      "image", "<image-url>"
    ],
    [
      // MULTIPLE
      // Tags used to describe the application
      "t", "<tag>"
    ],
    [
      // Website URL for the application
      "url", "<website-url>"
    ],
    [
      // Source code repository URL: https://github.com/example/android
      // Must be able to `git clone <repo-url>`
      "repository", "<repo-url>"
    ],
    [
      // Pointer to NIP-34 repository
      "a", "30617:<destination-pubkey>:<repo-id>", "<relay-url>"
    ],
    [
      // SHA1 commit id used to build the release
      "commit-id", "<sha1-commit-id>"
    ],
    [
      // REQUIRED, MULTIPLE
      // Platforms
      // NOTE: See Appendix A
      "f", "<platform-identifier>"
    ],
    [
      // SPDX license ID
      "license", "<spdx-id>"
    ]
  ]
}
```

All tags are optional but `d` MUST be present. Applications SHOULD use their  application or bundle identifier (typically in reverse-domain notation) as the `d` tag.

For `icon` and `image` tags any URL is valid but a Blossom [BUD-01](https://github.com/hzrd149/blossom/blob/master/buds/01.md#get-sha256---get-blob) endpoint is recommended.

`f` tags SHOULD be included to describe supported platforms that MUST match predefined identifiers. See [Appendix A](#).

License IDs are SPDX IDs as defined in https://spdx.org/licenses/.

## Software Release

A release is a parameterizable replaceable event, it is important for developers to be able to overwrite a bad release and update pointers to the right assets.

It also contains a release channel name.

```jsonc
{
  "kind": 30063,
  // Full release notes, Markdown allowed
  "content": "<release-notes>",
  "tags": [
    [
      // REQUIRED
      // Reverse-domain identifier: com.example.app
      "i", "<app-id>"
    ],
    [
      // REQUIRED
      // Version: 1.2.3, 0.1.2-rc1
      "version", "<version>"
    ],
    [
      // REQUIRED
      "d", "<identifier>@<version>"
    ],
    [
      // REQUIRED
      // See Appendix C for channel names
      "c", "<channel-name>"
    ],
    [
      // REQUIRED, MULTIPLE
      // Link to asset
      "e", "<asset-id>"
    ]
  ]
}
```

The `e` tags are pointers to all [Software Asset](#)s in this release. This event MUST be the authoritative source for assets belonging to a given version.

The identifier `i` MUST be the exact same used in the application. The `version` tag MUST be the same used in the linked assets. The `d` tag is required and typically is `<identifier>@<version>` but can be any other string.

## Software Asset

An asset is a regular non-replaceable event, mainly used to cryptographically link a file through its SHA-256 hash. This kind is an extension of [kind 1063](94.md).

```jsonc
{
  "kind": 3063,
  // Empty content
  "content": "",
  "tags": [
    // Tags derived from kind 1063
    [
      // REQUIRED
      // Reverse-domain identifier: com.example.app
      // NOTE: Here "i" stands for "identifier", not "infohash"
      "i", "<app-id>"
    ],
    [
      // URL of the asset, may be a Blossom URL
      "url", "<asset-url>"
    ],
    [
      // REQUIRED
      // MIME type of the asset
      // See Appendix B
      "m", "<mime-type>"
    ],
    [
      // REQUIRED
      // SHA-256 hash of the asset
      "x", "<sha256-hash>"
    ],
    [
      // Size of the asset in bytes
      "size", "<size-bytes>"
    ],

    // Software Asset-specific tags
    [
      // REQUIRED
      // Version: 1.2.3, 0.1.2-rc1
      "version", "<version>"
    ],
    [
      // REQUIRED, MULTIPLE
      // Platforms
      // NOTE: See Appendix A
      "f", "<platform-id>"
    ],
    [
      // Minimum operating system version (minimum compatibility)
      // NOTE: On Android this would be obtained from min_sdk_version
      "min_os_version", "<min-os-version>"
    ],
    [
      // Target operating system version (version software was designed for)
      // NOTE: On Android this would be obtained from target_sdk_version
      "target_os_version", "<target-os-version>"
    ],
    [
      // MULTIPLE
      // Supported Nostr NIP by this software
      "supported_nip": "<nip-id-string>"
    ],

    // Android-specific
    [
      // REQUIRED
      // Android version code
      "version_code", "<version-code-int>"
    ],
    [
      // REQUIRED, MULTIPLE
      // APK signature hash
      "apk_signature_hash", "<apk-sighash>"
    ],

    // CLI-specific
    // TBD: Define specific mime-types
    // Runtime dependencies, test script, service (long-running)

    // Linux-specific
    // TBD: Define specific mime-types
    // AppImage, other

    // MacOS-specific
    // TBD: Define specific mime-types
    // DMG, pkg, other
  ]
}
```

The identifier `i` MUST be the exact same used in the application. The `version` tag MUST be the same used in the release.

## Appendix A: Platform identifiers

Platform is defined as the specific underlying system on which the application is executed, a combination of operating system and hardware architecture. We use the `f` tag for this purpose, with the following identifiers loosely based off `uname -sm`:

| Identifier             | OS              | Architecture      |
| ---------              | ---             | ---               |
| `android-arm64-v8a`    | Android         | ARMv8-A           |
| `android-armeabi-v7a`  | Android         | ARMv7-A           |
| `android-x86`          | Android         | x86               |
| `android-x86_64`       | Android         | x86-64            |
| `darwin-arm64`         | MacOS           | ARM64             |
| `darwin-x86_64`        | MacOS           | x86-64            |
| `linux-aarch64`        | Linux           | ARM64             |
| `linux-x86_64`         | Linux           | x86-64            |
| `windows-aarch64`      | Windows         | ARM64             |
| `windows-x86_64`       | Windows         | x86-64            |
| `ios-arm64`            | iOS             | ARM64             |
| `web`                  | (Web browsers)  | -                 |

## Appendix B: Asset mime types

| MIME type                                     | OS              |       |
| ---------                                     | ---             | ---   |
| `application/vnd.android.package-archive`     | Android         |       |

TBC

## Appendix C: Channel names

 - `main` (Default)
 - `beta`
 - `nightly`
 - `dev`

## Appendix D: Attribution

Signers MAY include other pubkeys as `p` tags and `zap` tags as per [NIP-57 - Appendix G](57.md) in any of the defined event kinds. This is useful when the signer is not the maintainer of the software, or in the case of multiple authors.