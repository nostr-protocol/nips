# NIP-100: NostrReAction - Unified Interactions and Content Evolution

## 1. Abstract

This NIP introduces `NostrReAction` (NostrRA), a new protocol designed to unify "like", "share", and "reply"
interactions within the Nostr network. By consolidating these actions, including replies as content modifications,
into a single event type, leveraging IPFS for larger content, and implementing a notification mechanism,
`NostrReAction` aims to reduce network load, enhance content discoverability, simplify the user experience,
and establish a robust validation chain for content evolution. This unified approach ensures that all users
are notified of actions on their content and that the content with the greatest validation can be selected as
the main content.

## 2. Introduction

Current Nostr interactions like "like," "share," and "reply" often generate separate events, leading to
redundancy and a fragmented user experience. `NostrReAction` addresses this by creating a unified event
type that handles these actions as content interactions. This proposal emphasizes notifying content owners
about actions and content evolution, ensuring a transparent and consensual process for managing content.
Every interaction on an event is considered as a signature for a specific version of the content.
By gathering all interactions, you can then use an algorithm to present the content with the most "influence".

## 3. Goals

*   **Reduce Network Traffic:** Minimize the number of events by merging different interaction types into a single event.
*   **Enhance Content Discovery:** Improve content discoverability by aggregating interaction data and establishing a clear validation chain.
*   **Simplify User Experience:** Create a more cohesive and consistent interaction experience.
*   **Support Long Content:** Enable efficient handling of large content by leveraging IPFS CIDs.
*   **Preserve Content Integrity:** Ensure content integrity through a validation mechanism, allowing content to evolve while keeping a clear history.
*   **Establish a Validation Chain:** Provide mechanisms to accumulate validations on identical content based on a defined set of rules.
*   **Notify Content Owners:** Ensure content owners are informed of all actions on their content to maintain consistency.
*    **Content evolution**: Content owners and other users can propose modifications on a content and the author has a way to control the evolution.

## 4. Specification

### 4.1. Event Kinds:

*   **`kind: 10037`**: `NostrReAction` (NostrRA) event.
*   **`kind: 10038`**: Notification event for NostrReAction.

### 4.2. Tags:

**For `kind: 10037` (NostrRA):**

*   **`["original_event_id", <event_id_source>]` (required)**: The ID of the original event being interacted with.
*   **`["original_author_info", <pubkey_source>, <relay_url_source>]` (required)**: The pubkey and relay URL where the original event was published.
*   **`["action_type", <action_type>]` (required)**: The type of interaction: `like`, `share`, or `modify`.
*   **`["reply_to_event_id", <event_id_reply>]` (optional)**: The ID of the event being replied to, only if `action_type` is `reply`.
*   **`["ipfs_cid", <cid_ipfs>]` (optional)**: The IPFS CID for the content, if the `content` is larger than a certain limit.
*   **`["original_content_hash", <hash_content_original>]` (optional)**: The hash of the original `content`, used when `action_type` is `modify` or `reply`.
*   **`["reply_text", <texte_reply>]` (optional)**: Text of the reply, used when `action_type` is `reply`, when the reply is short.
*   **`["theme", <tag_value>]` (optional)**: A tag to describe the theme or topic of the event (can be multiple, for example `["theme", "nostr"], ["theme", "technology"]`).

**For `kind: 10038` (Notification):**

*   **`["original_event_id", <event_id_source>]` (required)**: The ID of the original event.
*   **`["original_author_info", <pubkey_source>, <relay_url_source>]` (required)**: The pubkey and relay URL of the content owner.
*   **`["repost_event_id", <event_id_repost>]` (required)**: The ID of the `NostrRA` event causing the notification.
*   **`["modify_event_id", <event_id_modify>]` (optional)**: If the notification is about a content modification, the ID of the `NostrRA` proposing the modification.

### 4.3. Action Types (`<action_type>`)

*   **`like`**: Indicates a "like" action (no additional content).
*   **`share`**: Indicates a "share" action (no additional content).
*   **`reply`**: Indicates a "reply" action.
*   **`modify`**: Indicates a proposal to modify the original content.
*   **`validate`**: Indicates that a proposed modification is validated.
*   **`refuse`**: Indicates that a proposed modification is refused.

### 4.4. Content (`content`)

**For `kind: 10037` (NostrRA):**

*   If `action_type` is `like` or `share`, the `content` MAY be empty or contain a brief message.
*   If `action_type` is `reply`:
    *   If the reply is short (under 140 characters), the `content` contains the text of the reply.
    *   If the reply is longer than 140 characters, the `content` contains `ipfs://<cid_ipfs>`.
*  If  `action_type` is `modify` :
     *   The `content` is the new `content` or `ipfs://<cid_ipfs>` if the new `content` is long.

**For `kind: 10038` (Notification):**

*   The `content` SHOULD be empty.

## 5. Workflow

1.  **Create a Reaction or Modification:**
    *   A user performs a "like," "share," or "reply" action on an event, or proposes a modification.
    *   An event of `kind: 10037` (`NostrRA`) is created with the correct `action_type`, `tags`, and formatted `content`.
        *   When a modification is proposed (including a reply), `original_content_hash` must contain a hash of the original `content`.
    *   An event of `kind: 10038` (Notification) is created to notify the content owner of this action.
    *   Both the `NostrRA` and the notification events are signed and published to the relays.

2.  **Receive `NostrRA` Event and Notification:**
    *   Relays receive the `NostrRA` event and the `Notification` event.
    *   Clients following the original event receive the `NostrRA` event and clients following the content owner receive the `Notification` event.

3.  **Content Validation and Evolution:**

    *   Content owners receive notifications of all interactions with their content. This allows content owners to keep a full history of all changes to their content and the validations related.
    *   When a modification is proposed (action type = `modify` or `reply`), content owners can review and validate the change by:
        *   Creating a `NostrRA` event with type `validate` to approve a proposed modification, or type `refuse` to reject the modification.
        *   Once approved, the new version is considered the main version.
       *  If the modification is refused, the original content will be used, until a new modification has been proposed and validated.

4. **Content Selection :**
  * An event is considered valid if and only if it has an associated `NostrRaAction` with `validate` and it must be from the original author.
   * The validated event is the reference for the "main version" of the content, this can be used to sort a list by influence.
   * Clients can choose to implement other algorithms to select the best version if they need different approach.

## 6. Examples

#### 6.1. Example: Like Action

```json
{
  "id": "6e987b011d667b71a32e48c97910d09104af21a3f26b1e0c09047f1d8e586f64",
  "pubkey": "2a2427f7e14721a98016c4e17c7d47252c7f9a9a48a2121b0704b8b434a3f873",
  "created_at": 1678956789,
  "kind": 10037,
  "tags": [
    ["original_event_id", "4f6a5d8c2b4d1a3e9f7c5b8a7d6e4c3b2a1f0e9d8c7b6a5f4e3d2c1b0a9f8e7d"],
    ["original_author_info", "4f6a5d8c2b4d1a3e9f7c5b8a7d6e4c3b2a1f0e9d8c7b6a5f4e3d2c1b0a9f8e7d", "wss://relay.example.com"],
    ["action_type", "like"]
  ],
  "content": "",
  "sig": "..."
}
```

```json
{
    "id": "event_id_notification_1",
    "pubkey": "pubkey_notification",
    "created_at": 1678886402,
    "kind": 10038,
    "content": "",
    "tags": [
        ["original_event_id", "4f6a5d8c2b4d1a3e9f7c5b8a7d6e4c3b2a1f0e9d8c7b6a5f4e3d2c1b0a9f8e7d"],
        ["original_author_info", "4f6a5d8c2b4d1a3e9f7c5b8a7d6e4c3b2a1f0e9d8c7b6a5f4e3d2c1b0a9f8e7d", "wss://relay.example.com"],
        ["repost_event_id", "6e987b011d667b71a32e48c97910d09104af21a3f26b1e0c09047f1d8e586f64"]
     ],
    "sig": "..."
}
```

#### 6.2. Example: Reply Action (short)

```json
{
  "id": "6e987b011d667b71a32e48c97910d09104af21a3f26b1e0c09047f1d8e586f65",
  "pubkey": "b23447f7e14721a98016c4e17c7d47252c7f9a9a48a2121b0704b8b434a3f873",
  "created_at": 1678956790,
  "kind": 10037,
  "tags": [
      ["original_event_id", "4f6a5d8c2b4d1a3e9f7c5b8a7d6e4c3b2a1f0e9d8c7b6a5f4e3d2c1b0a9f8e7d"],
      ["original_author_info", "4f6a5d8c2b4d1a3e9f7c5b8a7d6e4c3b2a1f0e9d8c7b6a5f4e3d2c1b0a9f8e7d", "wss://relay.example.com"],
      ["action_type", "reply"],
    ["reply_to_event_id", "1234567890abcdef..."],
        ["original_content_hash", "hash_original"]
  ],
  "content": "That's great!",
   "sig": "..."
}
```

```json
{
    "id": "event_id_notification_2",
    "pubkey": "pubkey_notification",
    "created_at": 1678886402,
    "kind": 10038,
    "content": "",
   "tags": [
        ["original_event_id", "4f6a5d8c2b4d1a3e9f7c5b8a7d6e4c3b2a1f0e9d8c7b6a5f4e3d2c1b0a9f8e7d"],
         ["original_author_info", "4f6a5d8c2b4d1a3e9f7c5b8a7d6e4c3b2a1f0e9d8c7b6a5f4e3d2c1b0a9f8e7d", "wss://relay.example.com"],
        ["repost_event_id", "6e987b011d667b71a32e48c97910d09104af21a3f26b1e0c09047f1d8e586f65"]
    ],
    "sig": "..."
}
```

#### 6.3. Example: Reply Action (long)

```json
{
  "id": "6e987b011d667b71a32e48c97910d09104af21a3f26b1e0c09047f1d8e586f66",
  "pubkey": "2b2427f7e14721a98016c4e17c7d47252c7f9a9a48a2121b0704b8b434a3f873",
  "created_at": 1678956791,
  "kind": 10037,
  "tags": [
    ["original_event_id", "4f6a5d8c2b4d1a3e9f7c5b8a7d6e4c3b2a1f0e9d8c7b6a5f4e3d2c1b0a9f8e7d"],
      ["original_author_info", "4f6a5d8c2b4d1a3e9f7c5b8a7d6e4c3b2a1f0e9d8c7b6a5f4e3d2c1b0a9f8e7d", "wss://relay.example.com"],
    ["action_type", "reply"],
        ["reply_to_event_id", "1234567890abcdef..."],
    ["ipfs_cid", "QmY7i5j..."],
        ["original_content_hash", "hash_original"]
  ],
  "content": "ipfs://QmY7i5j...",
  "sig": "..."
}
```

```json
{
    "id": "event_id_notification_3",
    "pubkey": "pubkey_notification",
    "created_at": 1678886402,
    "kind": 10038,
    "content": "",
   "tags": [
        ["original_event_id", "4f6a5d8c2b4d1a3e9f7c5b8a7d6e4c3b2a1f0e9d8c7b6a5f4e3d2c1b0a9f8e7d"],
         ["original_author_info", "4f6a5d8c2b4d1a3e9f7c5b8a7d6e4c3b2a1f0e9d8c7b6a5f4e3d2c1b0a9f8e7d", "wss://relay.example.com"],
        ["repost_event_id", "6e987b011d667b71a32e48c97910d09104af21a3f26b1e0c09047f1d8e586f66"]
    ],
    "sig": "..."
}
```

#### 6.4. Example: Modification

```json
{
     "id": "event_id_repost_modify_1",
    "pubkey": "pubkey_reposter_2",
    "created_at": 1678886403,
    "kind": 10037,
     "content": "Hello, Universe!",
    "tags": [
        ["original_event_id", "4f6a5d8c2b4d1a3e9f7c5b8a7d6e4c3b2a1f0e9d8c7b6a5f4e3d2c1b0a9f8e7d"],
        ["original_author_info", "4f6a5d8c2b4d1a3e9f7c5b8a7d6e4c3b2a1f0e9d8c7b6a5f4e3d2c1b0a9f8e7d", "wss://relay.example.com"],
        ["action_type", "modify"],
        ["original_content_hash", "hash_original"]
   ],
    "sig": "..."
}
```

```json
{
        "id": "event_id_notification_4",
        "pubkey": "pubkey_notification",
        "created_at": 1678886404,
        "kind": 10038,
       "content": "",
       "tags": [
        ["original_event_id", "4f6a5d8c2b4d1a3e9f7c5b8a7d6e4c3b2a1f0e9d8c7b6a5f4e3d2c1b0a9f8e7d"],
         ["original_author_info", "4f6a5d8c2b4d1a3e9f7c5b8a7d6e4c3b2a1f0e9d8c7b6a5f4e3d2c1b0a9f8e7d", "wss://relay.example.com"],
         ["repost_event_id", "event_id_repost_modify_1"],
        ["modify_event_id", "event_id_repost_modify_1"]
      ],
        "sig": "..."
  }
```
#### 6.5. Example : validation

```json
{
    "id": "event_id_repost_validate_1",
    "pubkey": "4f6a5d8c2b4d1a3e9f7c5b8a7d6e4c3b2a1f0e9d8c7b6a5f4e3d2c1b0a9f8e7d",
    "created_at": 1678886405,
    "kind": 10037,
     "content": "",
    "tags": [
      ["original_event_id", "4f6a5d8c2b4d1a3e9f7c5b8a7d6e4c3b2a1f0e9d8c7b6a5f4e3d2c1b0a9f8e7d"],
       ["original_author_info", "4f6a5d8c2b4d1a3e9f7c5b8a7d6e4c3b2a1f0e9d8c7b6a5f4e3d2c1b0a9f8e7d", "wss://relay.example.com"],
       ["action_type", "validate"],
       ["validate", "event_id_repost_modify_1"]
       ],
    "sig": "..."
}
```

## 7. Advantages

*   **Enhanced Content Ownership:** Content owners are notified of all interactions and changes related to their content.
*   **Content Validation:** Ensures a clear validation chain through notifications and explicit approval mechanisms.
*   **Improved Content Integrity:** The use of IPFS CIDs and hashes allows for validation that the content is identical.
*   **Robust Content Management:** Enables users to collaboratively build upon each other's content, while ensuring the content owner's control.
*   **Content ranking:** ranking is done based on the number of validation signatures on a content version.

## 8. Disadvantages

*   **Increased Complexity:** Implementing both `NostrRA` events and handling notifications might increase the complexity of clients.
*   **Additional Traffic:** The additional notification events might add to network traffic.

## 9. Considerations

*   **Client Implementation:** Clients MUST handle new `kind: 10037` and `kind: 10038` events.
*   **Relay Implementation:** Relays MUST accept and relay `kind: 10037` and `kind: 10038` events.
*   **Content Validation:** Clients should implement a robust method to validate content by analyzing the validation chain of events.

## 10. Conclusion

`NostrReAction` provides a new approach to handling common interactions in Nostr, ensuring content owners are informed of, and can participate in, the reuse and evolution of their content. This system should lead to more valuable interactions while preserving the core principles of Nostr by building a robust validation chain.
