NIP-101
======

Event Preservation Tip
--------------

`draft` `optional`

An event preservation tip is a `kind 303` event that is used to tip to a relay so that a particular event is preserved.

Tags
----

There MUST be always an `e` tag set to the `id` of the event that is being tried to be preserved. The `e` tag SHOULD include a relay hint pointing to a relay where the tip will be going to.

The SHOULD be a `p` tag set to the `pubkey` of the event being tried to be preserved.

If the event being preserved is an addressable event, an `a` SHOULD be included together with the `e` tag, it must be set to the coordinates (`kind:pubkey:d-tag`) of the event being tried to be preserved.

The tip SHOULD include a `k` tag with the stringified kind number of the event-to-be-preserved as its value.

**Example code**

```go
func make_tip_event(pubkey *String, privkey *String, tipped *NostrEvent) *NostrEvent {
    append(tipped.tags, "e", tipped.id, tipped.source_relays.first ?? "")
    append(tipped.tags, "p", tipped.pubkey)
    append(tipped.tags, "k", String(tipped.kind))
    var ev := NostrEvent(content: "+", pubkey: pubkey, kind: 7, tags: tags)
    ev.calculate_id()
    ev.sign(privkey: privkey)
    return ev
}
```
## Cost of Preservation

https://github.com/securitybrahh/nips/blob/1de44035fe049cbf48424fa27557be7a472340fe/11.md?plain=1#L166

## Tip Workflow

https://github.com/nostr-protocol/nips/blob/master/57.md#appendix-e-zap-receipt-event

```json
{
    "id": "67b48a14fb66c60c8f9070bdeb37afdfcc3d08ad01989460448e4081eddda446",
    "pubkey": "9630f464cca6a5147aa8a35f0bcdd3ce485324e732fd39e09233b1d848238f31",
    "created_at": 1674164545,
    "kind": 9735,
    "tags": [
      ["p", "32e1827635450ebb3c5a7d12c1f8e7b2b514439ac10a67eef3d9fd9c5c68e245"],
      ["P", "97c70a44366a6535c145b333f973ea86dfdc2d7a99da618c40c64705ad98e322"],
      ["e", "3624762a1274dd9636e0c552b53086d70bc88c165bc4dc0f9e836a1eaf86c3b8"],
      ["bolt11", "lnbc10u1p3unwfusp5t9r3yymhpfqculx78u027lxspgxcr2n2987mx2j55nnfs95nxnzqpp5jmrh92pfld78spqs78v9euf2385t83uvpwk9ldrlvf6ch7tpascqhp5zvkrmemgth3tufcvflmzjzfvjt023nazlhljz2n9hattj4f8jq8qxqyjw5qcqpjrzjqtc4fc44feggv7065fqe5m4ytjarg3repr5j9el35xhmtfexc42yczarjuqqfzqqqqqqqqlgqqqqqqgq9q9qxpqysgq079nkq507a5tw7xgttmj4u990j7wfggtrasah5gd4ywfr2pjcn29383tphp4t48gquelz9z78p4cq7ml3nrrphw5w6eckhjwmhezhnqpy6gyf0"],
      ["description", "{\"pubkey\":\"97c70a44366a6535c145b333f973ea86dfdc2d7a99da618c40c64705ad98e322\",\"content\":\"\",\"id\":\"d9cc14d50fcb8c27539aacf776882942c1a11ea4472f8cdec1dea82fab66279d\",\"created_at\":1674164539,\"sig\":\"77127f636577e9029276be060332ea565deaf89ff215a494ccff16ae3f757065e2bc59b2e8c113dd407917a010b3abd36c8d7ad84c0e3ab7dab3a0b0caa9835d\",\"kind\":9734,\"tags\":[[\"e\",\"3624762a1274dd9636e0c552b53086d70bc88c165bc4dc0f9e836a1eaf86c3b8\"],[\"p\",\"32e1827635450ebb3c5a7d12c1f8e7b2b514439ac10a67eef3d9fd9c5c68e245\"],[\"relays\",\"wss://relay.damus.io\",\"wss://nostr-relay.wlvs.space\",\"wss://nostr.fmt.wiz.biz\",\"wss://relay.nostr.bg\",\"wss://nostr.oxtr.dev\",\"wss://nostr.v0l.io\",\"wss://brb.io\",\"wss://nostr.bitcoiner.social\",\"ws://monad.jb55.com:8080\",\"wss://relay.snort.social\"]]}"],
      ["preimage", "5d006d2cf1e73c7148e7519a4c68adc81642ce0e25a432b2434c99f97344c15f"]
    ],
    "content": "",
  }
```

## Validating Zap Receipts

A relay can retrieve zap receipts on events and pubkeys using a NIP-01 filter, for example {"kinds": [9735], "#e": [...]}. Zaps MUST be validated using the following steps:

1. The zap receipt event's pubkey MUST be the same as the recipient's lnurl provider's nostrPubkey (retrieved in step 1 of the protocol flow).
2. The invoiceAmount contained in the bolt11 tag of the zap receipt MUST equal the amount tag of the zap request (if present).
3. The lnurl tag of the zap request (if present) SHOULD equal the recipient's lnurl.

## Assumption

A nostr event that is posted over a 'public` relay IS a public good i.e. https://unlicense.org/, hence the public has the full rights to preserve, it even for commercialization purposes. 

## Recommendations to relay implementators & operators

## Recommendations to client devolopers

## Request to the Tippers

## Enforcement

TBD

## Synonyms

https://github.com/nostr-protocol/nips/blob/master/11.md#event-retention

## Antonyms

[Expiration Timestamp](40.md) 

Right to be forgotten - [Request to Vanish](62.md) 

## Appendix

[IPFS problems: Pinning](https://fiatjaf.com/41163270.html)<sup>[archived?](https://njump.me/naddr1qqyrgvf3xcenydesqyghwumn8ghj7enfv96x5ctx9e3k7mgzyqalp33lewf5vdq847t6te0wvnags0gs0mu72kz8938tn24wlfze6qcyqqq823c9ckstx)</sup>
